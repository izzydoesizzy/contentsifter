{% if mode == "browse" %}
<p class="text-xs text-zinc-400 mb-4">{{ results|length }} {{ category_plural|default("extractions") }}</p>
{% else %}
<p class="text-xs text-zinc-400 mb-4">{{ results|length }} result{{ "s" if results|length != 1 else "" }} for &ldquo;{{ query }}&rdquo;{% if category_label %} in {{ category_label }}{% endif %}</p>
{% endif %}

<div class="space-y-3">
{% for r in results %}
  {% set eid = r.id %}
  <div class="bg-white rounded-xl border border-zinc-200 p-5 search-card"
       onclick="toggleDetail({{ eid }}, '/{{ slug }}/search/detail/{{ eid }}')">
    <!-- Summary -->
    <div class="flex items-start gap-3 mb-2">
      <span class="badge badge-{{ r.category }} shrink-0 mt-0.5">{{ r.category }}</span>
      <h3 class="text-sm font-medium text-zinc-900 flex-1 line-clamp-2">{{ r.title }}</h3>
      <!-- Quality dots -->
      <div class="flex gap-0.5 shrink-0 mt-1">
        {% for i in range(5) %}
        <span class="quality-dot {{ 'filled' if i < r.quality_score else 'empty' }}"></span>
        {% endfor %}
      </div>
    </div>

    <p class="text-sm text-zinc-500 mb-3 leading-relaxed line-clamp-2">{{ r.snippet }}</p>

    <div class="flex items-center justify-between">
      <div class="flex flex-wrap gap-1.5">
        {% for tag in r.tags[:6] %}
        <span class="tag-pill">{{ tag }}</span>
        {% endfor %}
        {% if r.tags|length > 6 %}
        <span class="text-xs text-zinc-400">+{{ r.tags|length - 6 }}</span>
        {% endif %}
      </div>
      <div class="flex items-center gap-2 shrink-0">
        <span class="text-xs text-zinc-400">{{ r.call_date[:10] if r.call_date else "" }}</span>
        <svg id="chevron-{{ eid }}" class="w-4 h-4 text-zinc-400 chevron-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
        </svg>
      </div>
    </div>

    <!-- Detail (expand-in-place, loaded on first click) -->
    <div id="detail-{{ eid }}" class="detail-content"></div>
  </div>
{% endfor %}
</div>
