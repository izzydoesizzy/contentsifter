{% if slot and slot.status != 'empty' %}
<!-- Filled card -->
<div class="planner-card"
     onclick="openSidePanel('{{ current_client.slug }}', '{{ day.day_name }}', '{{ week_start }}')"
     draggable="true"
     data-day="{{ day.day_name }}"
     ondragstart="handleCardDragStart(event)"
     ondragend="handleCardDragEnd(event)">
  <div class="flex items-center gap-1.5 mb-2">
    <span class="status-dot status-{{ slot.status }}"></span>
    <span class="text-xs font-medium text-zinc-500 capitalize">{{ slot.status|replace('_', ' ') }}</span>
  </div>
  <p class="text-sm font-medium text-zinc-800 line-clamp-2">{{ slot.title or 'Untitled' }}</p>
  {% if slot.content %}
  <p class="mt-1.5 text-xs text-zinc-400 line-clamp-3">{{ slot.content[:120] }}</p>
  {% endif %}
  <div class="mt-2 flex items-center justify-between">
    <span class="badge badge-{{ day.format_type }} text-xs">{{ day.format_type }}</span>
    <svg class="w-3 h-3 text-zinc-300 grip-handle" viewBox="0 0 24 24" fill="currentColor">
      <circle cx="8" cy="6" r="1.5"/><circle cx="16" cy="6" r="1.5"/>
      <circle cx="8" cy="12" r="1.5"/><circle cx="16" cy="12" r="1.5"/>
      <circle cx="8" cy="18" r="1.5"/><circle cx="16" cy="18" r="1.5"/>
    </svg>
  </div>
</div>
{% else %}
<!-- Empty slot -->
<div class="planner-empty-slot">
  {% if has_api_key %}
  <form hx-post="/{{ current_client.slug }}/planner/slot/{{ day.day_name }}/generate"
        hx-target="#slot-{{ day.day_name }}"
        hx-swap="innerHTML"
        hx-indicator="#spinner-{{ day.day_name }}">
    <input type="hidden" name="week" value="{{ week_start }}">
    <button type="submit"
            class="inline-flex items-center gap-1 px-2.5 py-1.5 text-xs font-medium text-indigo-600 hover:text-indigo-700 hover:bg-indigo-50 rounded-md transition-colors">
      <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/></svg>
      Generate
    </button>
  </form>
  <div id="spinner-{{ day.day_name }}" class="htmx-indicator">
    <svg class="animate-spin w-5 h-5 text-indigo-500 mx-auto" fill="none" viewBox="0 0 24 24">
      <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
      <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"></path>
    </svg>
    <p class="text-xs text-zinc-400 mt-1">Generating...</p>
  </div>
  {% endif %}
  <p class="text-xs text-zinc-300 mt-1">or drop a draft</p>
</div>
{% endif %}
